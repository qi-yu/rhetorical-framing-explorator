<p-toast [position]="'top-right'"></p-toast>
<div class="card flex justify-content-center" class="not-full-width">
    <p-card header="Upload File to Annotate:">
        <p-fileUpload 
            name="myfile" 
            [url]="url+'/upload'" 
            [multiple]="true" 
            accept=".xml, .csv, .tsv" 
            [maxFileSize]="1000000"
            [auto]="true"
            (onUpload)="onUploadFile($event)"
            [disabled]="uploadCompleted === true"
        >
            <ng-template pTemplate="content">
                <div (dragenter)="onDragEnter($event)" (dragleave)="onDragLeave($event)">
                   <div class="drag-and-drop-box" [ngClass]="{'drag-over': isFileDragOver}">
                        <p>(Drag and drop files here to upload)</p>
                   </div>
                </div>       
                
                <ng-container *ngIf="uploadedFiles.length > 0; else noFileMessage">
                    <p-table [value]="uploadedFiles" [tableStyle]="{ 'min-width': '50rem' }" styleClass="p-datatable-gridlines p-datatable-striped">
                        <ng-template pTemplate="caption">
                            <div class="flex align-items-center justify-content-between">Uploaded Files:</div>
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th>File</th>
                                <th>Size</th>
                                <th>Actions</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-file let-i="index">
                            <tr>
                                <td>{{ file.filename }}</td>
                                <td>{{ file.size | fileSize }}</td>
                                <td>
                                    <div class="container">
                                        <p-checkbox 
                                            [(ngModel)]="file.selectedForAnalyses" 
                                            [binary]="true" 
                                            [inputId]="'fileToAnalyze-' + i"
                                            (click)="onToggleFileForAnalyses(file)"
                                        ></p-checkbox>
                                        <label [for]="'fileToAnalyze-' + i" style="padding-left: 10px;">USE FOR ANALYSES</label>
                                        <span class="container" style="padding-left: 20px;">
                                            <p-button (click)="onDeleteUploadedFile(file)" [id]="'delete' + i" icon="pi pi-trash" styleClass="p-button-rounded p-button-danger p-button-text"></p-button>
                                            <label [for]="'delete' + i">DELETE</label>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </ng-container>
                <ng-template #noFileMessage>
                    <p>(No file uploaded yet)</p>
                </ng-template>
            </ng-template>
        </p-fileUpload>
    </p-card>
</div>